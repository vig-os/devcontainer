---
type: pull_request
state: closed (merged)
branch: bugfix/187-fix-just-check-path → dev
created: 2026-02-24T16:51:51Z
updated: 2026-02-24T17:27:11Z
author: gerchowl
author_url: https://github.com/gerchowl
url: https://github.com/vig-os/devcontainer/pull/189
comments: 0
labels: none
assignees: gerchowl
milestone: none
projects: none
relationship: none
merged: 2026-02-24T17:27:09Z
synced: 2026-02-25T04:26:05.844Z
---

# [PR 189](https://github.com/vig-os/devcontainer/pull/189) fix: just check uses wrong path (#187)

## Description

Fixes the `just check` recipe path resolution bug. The recipe used `dirname(justfile_directory())` to locate `.devcontainer/scripts/version-check.sh`, which resolved one level above the project root in both deployed workspaces and the devcontainer repo. Replaced with `source_directory()/scripts` (matching the pattern in `justfile.gh`) so the path resolves correctly in both contexts.

## Type of Change

<!-- Mark the relevant option(s) with an 'x' -->

- [ ] `feat` -- New feature
- [x] `fix` -- Bug fix
- [ ] `docs` -- Documentation only
- [ ] `chore` -- Maintenance task (deps, config, etc.)
- [ ] `refactor` -- Code restructuring (no behavior change)
- [ ] `test` -- Adding or updating tests
- [ ] `ci` -- CI/CD pipeline changes
- [ ] `build` -- Build system or dependency changes
- [ ] `revert` -- Reverts a previous commit
- [ ] `style` -- Code style (formatting, whitespace)

### Modifiers

- [ ] Breaking change (`!`) -- This change breaks backward compatibility

## Changes Made

- `justfile.base`: Replace `dirname(justfile_directory())` with `source_directory()/scripts` in check recipe
- `assets/workspace/.devcontainer/justfile.base`: Synced via `just sync-workspace`
- `tests/test_integration.py`: Add regression test `test_just_check_config_via_just_command` that runs `just check config` from workspace
- `CHANGELOG.md`: Add entry under Fixed

## Changelog Entry

### Fixed

- **just check uses wrong path — justfile_directory() resolves incorrectly in imported justfile.base** ([#187](https://github.com/vig-os/devcontainer/issues/187))
  - Replace `dirname(justfile_directory())` with `source_directory()/scripts` to correctly locate version-check.sh in deployed workspaces and devcontainer repo
  - Regression test: `just check config` runs successfully from workspace

## Testing

<!-- Describe the tests you ran and how to verify your changes -->
- [x] Tests pass locally (`just test`)
- [ ] Manual testing performed (describe below)

### Manual Testing Details

Integration tests pass (110 passed). Regression test `test_just_check_config_via_just_command` verifies `just check config` runs successfully from initialized workspace. BATS and hadolint precommit hooks failed due to environment (bats-support library, Docker daemon) — unrelated to this fix.

## Checklist

<!-- Mark completed items with an 'x' -->
- [x] My code follows the project's style guidelines
- [x] I have performed a self-review of my code
- [ ] I have commented my code, particularly in hard-to-understand areas
- [ ] I have updated the documentation accordingly (edit `docs/templates/`, then run `just docs`)
- [x] I have updated `CHANGELOG.md` in the `[Unreleased]` section (and pasted the entry above)
- [x] My changes generate no new warnings or errors
- [x] I have added tests that prove my fix is effective or that my feature works
- [x] New and existing unit tests pass locally with my changes
- [ ] Any dependent changes have been merged and published

## Additional Notes

TDD: regression test added first (RED), then fix (GREEN). The fix uses `source_directory()` (available since just 1.27.0), which returns the directory of the current source file — correct for imported justfile.base in both workspace and repo contexts.

Refs: #187



---
---

## Commits

### Commit 1: [cb9eeca](https://github.com/vig-os/devcontainer/commit/cb9eeca160c04013370465aaf4bfdb40d19ce4d0) by [gerchowl](https://github.com/gerchowl) on February 24, 2026 at 04:43 PM
test: add regression test for just check path resolution, 22 files modified (tests/test_integration.py)

### Commit 2: [27782bd](https://github.com/vig-os/devcontainer/commit/27782bd4bf42061bbc48e0fcefa039893e57f29e) by [gerchowl](https://github.com/gerchowl) on February 24, 2026 at 04:46 PM
fix(justfile): use source_directory() for check recipe path resolution, 9 files modified (assets/workspace/.devcontainer/justfile.base, justfile.base, tests/test_integration.py)

### Commit 3: [c32304c](https://github.com/vig-os/devcontainer/commit/c32304c303e0df9aae26743cef375d50e6cbb419) by [gerchowl](https://github.com/gerchowl) on February 24, 2026 at 04:51 PM
docs(changelog): add entry for just check path fix, 3 files modified (CHANGELOG.md)

### Commit 4: [743c84f](https://github.com/vig-os/devcontainer/commit/743c84fd8d0f277f4d1d336c2952b3a9b9fe3ae4) by [gerchowl](https://github.com/gerchowl) on February 24, 2026 at 05:01 PM
Merge branch 'dev' into bugfix/187-fix-just-check-path, 125 files modified (.github/actions/test-project/action.yml, CHANGELOG.md, scripts/gh_issues.py, tests/test_gh_issues.py)
