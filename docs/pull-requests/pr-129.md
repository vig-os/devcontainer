---
type: pull_request
state: open
branch: feature/99-just-gh-issues-overview-test-coverage → dev
created: 2026-02-20T16:40:19Z
updated: 2026-02-20T23:36:23Z
author: gerchowl
author_url: https://github.com/gerchowl
url: https://github.com/vig-os/devcontainer/pull/129
comments: 1
labels: none
assignees: gerchowl
milestone: none
projects: none
relationship: none
synced: 2026-02-21T04:11:24.516Z
---

# [PR 129](https://github.com/vig-os/devcontainer/pull/129) test(gh-issues): add unit, integration, and smoke tests for gh_issues.py (#99)

# Pull Request

## Description

Add comprehensive test coverage for `scripts/gh_issues.py` across three layers: unit tests for pure-logic functions, container integration tests for runtime dependency verification, and an integration smoke test for the `just gh-issues` recipe. The smoke test uncovered a missing `rich` dependency in the workspace template `pyproject.toml`, which is also fixed here.

## Related Issue(s)

Closes #99

## Type of Change

- [ ] Bug fix (non-breaking change which fixes an issue)
- [ ] New feature (non-breaking change which adds functionality)
- [ ] Breaking change (fix or feature that would cause existing functionality to not work as expected)
- [ ] Documentation update
- [ ] Refactoring (no functional changes)
- [ ] CI / Build change
- [x] Test updates

## Changes Made

- **57 unit tests** (`tests/test_gh_issues.py`) covering all 9 pure-logic functions: `_styled`, `_extract_label`, `_extract_type`, `_extract_scope`, `_clean_title`, `_format_assignees`, `_infer_review`, `_extract_reviewers`, `_build_cross_refs`
- **2 container integration tests** (`tests/test_image.py`) verifying `rich` importability and `gh_issues.py` importability inside the container image
- **1 smoke test** (`tests/test_integration.py`) running `just gh-issues` in a devcontainer, validating the full recipe wiring end-to-end
- **Bug fix**: added `rich>=13.0` to `assets/workspace/pyproject.toml` dependencies — `uv run python` in the project venv couldn't find `rich` (only installed system-wide), causing `ModuleNotFoundError`

## Changelog Entry

No changelog needed — tests-only change with no user-visible impact. The `rich` dependency fix affects the workspace template for new projects only.

## Testing

- [x] Tests pass locally (`just test`)
- [x] Manual testing performed (describe below)

### Manual Testing Details

- `uv run pytest tests/test_gh_issues.py -v` — 57/57 passed
- `uv run pytest tests/test_integration.py::TestGhIssuesSmoke -v -s` — skipped (expected: test workspace has no GitHub repo context)
- Container image rebuilt with `just build dev` to verify `rich` dependency fix

## Checklist

- [x] My code follows the project's style guidelines
- [x] I have performed a self-review of my code
- [x] I have commented my code, particularly in hard-to-understand areas
- [x] I have updated the documentation accordingly (edit `docs/templates/`, then run `just docs`)
- [x] I have updated `CHANGELOG.md` in the `[Unreleased]` section (and pasted the entry above)
- [x] My changes generate no new warnings or errors
- [x] I have added tests that prove my fix is effective or that my feature works
- [x] New and existing unit tests pass locally with my changes
- [x] Any dependent changes have been merged and published

## Additional Notes

- The smoke test skips when `gh` CLI calls fail (no repo context in test workspace or no auth). It would fully pass in a workspace with a real GitHub repo and authentication.
- The existing `test_manifest_files` already covers file existence and checksum verification for the deployed `gh_issues.py` via the sync manifest.



---
---

## Review Threads (1)

### Review by [@c-vigo](https://github.com/c-vigo)

_Posted on February 20, 2026 at 10:59 PM_

_File: [`assets/workspace/pyproject.toml`](https://github.com/vig-os/devcontainer/pull/129#discussion_r2835415754)_

```diff
@@ -3,7 +3,9 @@ name = "{{SHORT_NAME}}"
 version = "0.1.0"
 description = "{{SHORT_NAME}} project"
 requires-python = ">=3.12"
-dependencies = []
+dependencies = [
+    "rich>=13.0",
+]
```

I'd argue that "rich" is not a project dependency but a devcontainer one, like vig-utils, ruff or pre-commit, and should be installed in the Containerfile, systemwide. Users are expected to modify this file and would uninstall "rich"

---

