---
type: pull_request
state: closed (merged)
branch: feature/99-just-gh-issues-overview-test-coverage → dev
created: 2026-02-20T16:40:19Z
updated: 2026-02-21T17:56:51Z
author: gerchowl
author_url: https://github.com/gerchowl
url: https://github.com/vig-os/devcontainer/pull/129
comments: 1
labels: none
assignees: gerchowl
milestone: none
projects: none
relationship: none
merged: 2026-02-21T17:56:49Z
synced: 2026-02-22T04:23:38.086Z
---

# [PR 129](https://github.com/vig-os/devcontainer/pull/129) test(gh-issues): add unit, integration, and smoke tests for gh_issues.py (#99)

# Pull Request

## Description

Add comprehensive test coverage for `scripts/gh_issues.py` across three layers: unit tests for pure-logic functions, container integration tests for runtime dependency verification, and an integration smoke test for the `just gh-issues` recipe. The smoke test uncovered a missing `rich` dependency in the workspace template `pyproject.toml`, which is also fixed here.

## Related Issue(s)

Closes #99

## Type of Change

- [ ] Bug fix (non-breaking change which fixes an issue)
- [ ] New feature (non-breaking change which adds functionality)
- [ ] Breaking change (fix or feature that would cause existing functionality to not work as expected)
- [ ] Documentation update
- [ ] Refactoring (no functional changes)
- [ ] CI / Build change
- [x] Test updates

## Changes Made

- **57 unit tests** (`tests/test_gh_issues.py`) covering all 9 pure-logic functions: `_styled`, `_extract_label`, `_extract_type`, `_extract_scope`, `_clean_title`, `_format_assignees`, `_infer_review`, `_extract_reviewers`, `_build_cross_refs`
- **2 container integration tests** (`tests/test_image.py`) verifying `rich` importability and `gh_issues.py` importability inside the container image
- **1 smoke test** (`tests/test_integration.py`) running `just gh-issues` in a devcontainer, validating the full recipe wiring end-to-end
- **Bug fix**: added `rich>=13.0` to `assets/workspace/pyproject.toml` dependencies — `uv run python` in the project venv couldn't find `rich` (only installed system-wide), causing `ModuleNotFoundError`

## Changelog Entry

No changelog needed — tests-only change with no user-visible impact. The `rich` dependency fix affects the workspace template for new projects only.

## Testing

- [x] Tests pass locally (`just test`)
- [x] Manual testing performed (describe below)

### Manual Testing Details

- `uv run pytest tests/test_gh_issues.py -v` — 57/57 passed
- `uv run pytest tests/test_integration.py::TestGhIssuesSmoke -v -s` — skipped (expected: test workspace has no GitHub repo context)
- Container image rebuilt with `just build dev` to verify `rich` dependency fix

## Checklist

- [x] My code follows the project's style guidelines
- [x] I have performed a self-review of my code
- [x] I have commented my code, particularly in hard-to-understand areas
- [x] I have updated the documentation accordingly (edit `docs/templates/`, then run `just docs`)
- [x] I have updated `CHANGELOG.md` in the `[Unreleased]` section (and pasted the entry above)
- [x] My changes generate no new warnings or errors
- [x] I have added tests that prove my fix is effective or that my feature works
- [x] New and existing unit tests pass locally with my changes
- [x] Any dependent changes have been merged and published

## Additional Notes

- The smoke test skips when `gh` CLI calls fail (no repo context in test workspace or no auth). It would fully pass in a workspace with a real GitHub repo and authentication.
- The existing `test_manifest_files` already covers file existence and checksum verification for the deployed `gh_issues.py` via the sync manifest.



---
---

## Review Threads (1)

### Review by [@c-vigo](https://github.com/c-vigo)

_Posted on February 20, 2026 at 10:59 PM_

_File: [`assets/workspace/pyproject.toml`](https://github.com/vig-os/devcontainer/pull/129#discussion_r2835415754)_

```diff
@@ -3,7 +3,9 @@ name = "{{SHORT_NAME}}"
 version = "0.1.0"
 description = "{{SHORT_NAME}} project"
 requires-python = ">=3.12"
-dependencies = []
+dependencies = [
+    "rich>=13.0",
+]
```

I'd argue that "rich" is not a project dependency but a devcontainer one, like vig-utils, ruff or pre-commit, and should be installed in the Containerfile, systemwide. Users are expected to modify this file and would uninstall "rich"


---
---

## Commits

### Commit 1: [4ca3787](https://github.com/vig-os/devcontainer/commit/4ca3787becc986d225d165a35eab70b401f7d09c) by [gerchowl](https://github.com/gerchowl) on February 20, 2026 at 09:28 AM
feat(gh-issues): add reviewer, assignee columns and review inference to PR table, 60 files modified (scripts/gh_issues.py)

### Commit 2: [2efb86b](https://github.com/vig-os/devcontainer/commit/2efb86bcadac543eeee89c59b0579914039d40a0) by [gerchowl](https://github.com/gerchowl) on February 20, 2026 at 04:13 PM
test(gh-issues): add unit tests for pure-logic functions, 326 files modified (tests/test_gh_issues.py)

### Commit 3: [b5d6fa8](https://github.com/vig-os/devcontainer/commit/b5d6fa88fa7d1a58a0767e3bf34fcc2a1a9a9420) by [gerchowl](https://github.com/gerchowl) on February 20, 2026 at 04:14 PM
test(gh-issues): add container integration tests for runtime deps, 22 files modified (tests/test_image.py)

### Commit 4: [b5b00ad](https://github.com/vig-os/devcontainer/commit/b5b00adb65f8c0a2dd89161a6d99ab132b2b52f9) by [gerchowl](https://github.com/gerchowl) on February 20, 2026 at 04:19 PM
test(gh-issues): add smoke test for just gh-issues recipe, 56 files modified (tests/test_integration.py)

### Commit 5: [d37bf47](https://github.com/vig-os/devcontainer/commit/d37bf47032c46f9a73dad75a501233e9775e0d52) by [gerchowl](https://github.com/gerchowl) on February 20, 2026 at 04:27 PM
fix(workspace): add rich to pyproject.toml dependencies, 49 files modified (assets/workspace/pyproject.toml, tests/test_integration.py)

### Commit 6: [b790eb2](https://github.com/vig-os/devcontainer/commit/b790eb2dd3207a41a5dfaa9f408835534b6eb493) by [gerchowl](https://github.com/gerchowl) on February 20, 2026 at 10:52 PM
fix(test): use uv run for gh_issues container tests, 20 files modified (tests/test_image.py)

### Commit 7: [6540ca4](https://github.com/vig-os/devcontainer/commit/6540ca496a1c0e6ea75e4fd855bed1b21c4726ec) by [gerchowl](https://github.com/gerchowl) on February 20, 2026 at 11:12 PM
fix(test): use pre-built venv for gh_issues container tests, 17 files modified (tests/test_image.py)

### Commit 8: [9b7d555](https://github.com/vig-os/devcontainer/commit/9b7d555e86d8bb2a78b55a58a1110f6645b62c90) by [gerchowl](https://github.com/gerchowl) on February 20, 2026 at 11:25 PM
fix: install rich system-wide instead of as project dependency, 26 files modified (Containerfile, assets/workspace/.devcontainer/justfile.gh, assets/workspace/pyproject.toml, justfile.gh, tests/test_image.py)

### Commit 9: [5b1500a](https://github.com/vig-os/devcontainer/commit/5b1500ab5bf540f77ec00a8233208c73e98c0f0d) by [gerchowl](https://github.com/gerchowl) on February 20, 2026 at 11:35 PM
Merge remote-tracking branch 'origin/dev' into feature/99-just-gh-issues-overview-test-coverage, 17321 files modified

### Commit 10: [d9c29ff](https://github.com/vig-os/devcontainer/commit/d9c29ffc1245be4d25b52e295d98ad7b6d92a373) by [gerchowl](https://github.com/gerchowl) on February 20, 2026 at 11:35 PM
chore: sync workspace templates after dev merge, 782 files modified
