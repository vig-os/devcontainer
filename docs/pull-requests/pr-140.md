---
type: pull_request
state: open
branch: feature/89-consolidate-sync-manifest-utils → dev
created: 2026-02-21T18:00:15Z
updated: 2026-02-21T20:59:24Z
author: gerchowl
author_url: https://github.com/gerchowl
url: https://github.com/vig-os/devcontainer/pull/140
comments: 0
labels: none
assignees: none
milestone: none
projects: none
relationship: none
synced: 2026-02-22T04:23:31.967Z
---

# [PR 140](https://github.com/vig-os/devcontainer/pull/140) refactor: consolidate sync_manifest.py and utils.py into manifest-as-config (#89)

Refactors sync_manifest.py and utils.py per #89:

- **Extract transform classes** to `scripts/transforms.py` (Sed, RemoveLines, StripTrailingBlankLines, RemoveBlock, RemovePrecommitHooks, ReplaceBlock)
- **Unify sed logic** via `substitute_in_file()` in utils — shared by `sed_inplace` (literal) and Sed transform (regex)
- **Convert MANIFEST to declarative config** — `scripts/manifest.toml` with TOML, loaded via tomllib

### Acceptance criteria
- [x] No duplicate text-replacement logic between the two files
- [x] `sync_manifest.py` manifest entries are declarative config (not Python code defining data)
- [x] `utils.py` CLI (`version`, `sed` subcommands) continues to work unchanged
- [x] `just sync-workspace` produces identical output before and after
- [x] All existing tests pass

Refs: #89

Made with [Cursor](https://cursor.com)
