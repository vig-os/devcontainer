---
type: pull_request
state: closed (merged)
branch: feature/89-consolidate-sync-manifest-utils → dev
created: 2026-02-21T18:00:15Z
updated: 2026-02-23T22:50:43Z
author: gerchowl
author_url: https://github.com/gerchowl
url: https://github.com/vig-os/devcontainer/pull/140
comments: 0
labels: none
assignees: none
milestone: none
projects: none
relationship: none
merged: 2026-02-23T22:50:41Z
synced: 2026-02-24T04:24:18.942Z
---

# [PR 140](https://github.com/vig-os/devcontainer/pull/140) refactor: consolidate sync_manifest.py and utils.py into manifest-as-config (#89)

Refactors sync_manifest.py and utils.py per #89:

- **Extract transform classes** to `scripts/transforms.py` (Sed, RemoveLines, StripTrailingBlankLines, RemoveBlock, RemovePrecommitHooks, ReplaceBlock)
- **Unify sed logic** via `substitute_in_file()` in utils — shared by `sed_inplace` (literal) and Sed transform (regex)
- **Convert MANIFEST to declarative config** — `scripts/manifest.toml` with TOML, loaded via tomllib

### Acceptance criteria
- [x] No duplicate text-replacement logic between the two files
- [x] `sync_manifest.py` manifest entries are declarative config (not Python code defining data)
- [x] `utils.py` CLI (`version`, `sed` subcommands) continues to work unchanged
- [x] `just sync-workspace` produces identical output before and after
- [x] All existing tests pass

Refs: #89

Made with [Cursor](https://cursor.com)


---
---

## Commits

### Commit 1: [11fb521](https://github.com/vig-os/devcontainer/commit/11fb521efefb5035f3b108fa3fafc64f9f194b5c) by [gerchowl](https://github.com/gerchowl) on February 21, 2026 at 01:29 AM
test: add transforms module tests for Sed and RemoveLines, 46 files modified (tests/test_transforms.py)

### Commit 2: [194b376](https://github.com/vig-os/devcontainer/commit/194b376484cbe02208948a570effd0d10f77dbdd) by [gerchowl](https://github.com/gerchowl) on February 21, 2026 at 01:31 AM
refactor: extract transform classes from sync_manifest to transforms.py, 416 files modified (scripts/sync_manifest.py, scripts/transforms.py, tests/test_transforms.py)

### Commit 3: [b6e2cf7](https://github.com/vig-os/devcontainer/commit/b6e2cf7cd24a75b4d81c7f702d6aa4d35f7fa588) by [gerchowl](https://github.com/gerchowl) on February 21, 2026 at 01:33 AM
refactor: unify sed logic via substitute_in_file in utils, 92 files modified (scripts/transforms.py, scripts/utils.py, tests/test_utils.py)

### Commit 4: [6fd5845](https://github.com/vig-os/devcontainer/commit/6fd584588bc8efe878a78198f9d7e99b0b19985d) by [gerchowl](https://github.com/gerchowl) on February 21, 2026 at 01:35 AM
refactor: convert MANIFEST to declarative manifest.toml, 231 files modified (CHANGELOG.md, scripts/manifest.toml, scripts/sync_manifest.py)

### Commit 5: [73fa262](https://github.com/vig-os/devcontainer/commit/73fa262200489b37cc053bf1a995914e098c18f9) by [gerchowl](https://github.com/gerchowl) on February 21, 2026 at 05:59 PM
Merge dev into feature/89-consolidate-sync-manifest-utils, 2616 files modified

### Commit 6: [3febe45](https://github.com/vig-os/devcontainer/commit/3febe450def9944d52ed5f80249928bdc02eb301) by [gerchowl](https://github.com/gerchowl) on February 21, 2026 at 06:35 PM
Merge branch 'dev' into feature/89-consolidate-sync-manifest-utils, 41 files modified (CHANGELOG.md, Containerfile, tests/test_image.py)

### Commit 7: [737c372](https://github.com/vig-os/devcontainer/commit/737c3727763c4cac44bb22665e6506f73da44bc8) by [gerchowl](https://github.com/gerchowl) on February 21, 2026 at 06:44 PM
Merge branch 'dev' into feature/89-consolidate-sync-manifest-utils, 36 files modified (CHANGELOG.md, scripts/gh_issues.py, tests/test_gh_issues.py)

### Commit 8: [59d8efd](https://github.com/vig-os/devcontainer/commit/59d8efd6928c25d33899d3e8cb80937a0cc0eb55) by [gerchowl](https://github.com/gerchowl) on February 21, 2026 at 08:59 PM
Merge branch 'dev' into feature/89-consolidate-sync-manifest-utils, 1621 files modified

### Commit 9: [70eff3a](https://github.com/vig-os/devcontainer/commit/70eff3afc02ab60bca97c0422ebaf6027191565f) by [gerchowl](https://github.com/gerchowl) on February 23, 2026 at 07:34 AM
Merge branch 'dev' into feature/89-consolidate-sync-manifest-utils, 4122 files modified

### Commit 10: [9138d28](https://github.com/vig-os/devcontainer/commit/9138d289608fb1cd34585ddefe9b2bea6e966876) by [gerchowl](https://github.com/gerchowl) on February 23, 2026 at 08:04 AM
fix: resolve merge conflicts in sync_manifest and CHANGELOG, 95 files modified (CHANGELOG.md, scripts/manifest.toml, scripts/sync_manifest.py)
