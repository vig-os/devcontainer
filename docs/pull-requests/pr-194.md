---
type: pull_request
state: closed (merged)
branch: bugfix/163-wrong-identity-tags → dev
created: 2026-02-24T18:00:30Z
updated: 2026-02-25T10:16:19Z
author: gerchowl
author_url: https://github.com/gerchowl
url: https://github.com/vig-os/devcontainer/pull/194
comments: 0
labels: none
assignees: gerchowl
milestone: none
projects: none
relationship: none
merged: 2026-02-25T10:16:16Z
synced: 2026-02-26T04:22:33.537Z
---

# [PR 194](https://github.com/vig-os/devcontainer/pull/194) fix(vigutils): AI agent identity enforcement (#163)

## Description

Implements the full design from issue #163: five enforcement layers to strip AI agent identity from commits and PRs.

- **Canonical blocklist** `.github/agent-blocklist.toml` — single source of truth for trailers, names, emails
- **prepare-commit-msg hook** — strips Co-authored-by trailers before commit-msg validation
- **Pre-commit hook** — rejects commits when author/committer matches blocklist (skips in CI)
- **validate-commit-msg** — `--blocked-patterns` for TOML blocklist; shared `agent_blocklist` module
- **pr-title-check CI** — scans PR title and body for agent fingerprints
- **Skill rules** — strengthened in git_commit, worktree_execute, worktree_pr

Closes #163

## Type of Change

- [x] `fix` -- Bug fix

### Modifiers

- [ ] Breaking change (`!`) -- This change breaks backward compatibility

## Changes Made

- `.github/agent-blocklist.toml` — canonical blocklist (trailers, names, emails)
- `scripts/prepare-commit-msg-strip-trailers.py` — strips trailer patterns from COMMIT_EDITMSG
- `scripts/check-agent-identity.py` — rejects author/committer matching blocklist
- `scripts/check-pr-agent-fingerprints.py` — CI script for PR body scan
- `packages/vig-utils/src/vig_utils/agent_blocklist.py` — shared load_blocklist, contains_agent_fingerprint
- `packages/vig-utils` — validate_commit_msg extended with `--blocked-patterns`
- `.pre-commit-config.yaml` — prepare-commit-msg, check-agent-identity, validate-commit-msg --blocked-patterns
- `.githooks/prepare-commit-msg` — runs pre-commit prepare-commit-msg stage
- `.github/workflows/pr-title-check.yml` — new step to check PR body
- `scripts/manifest.toml` — agent-blocklist.toml + new scripts synced to workspace
- Skill rules updated in git_commit, worktree_execute, worktree_pr

## Changelog Entry

### Fixed

- **AI agent identity enforcement: blocklist, prepare-commit-msg, author check, PR body scan** ([#163](https://github.com/vig-os/devcontainer/issues/163))
  - Canonical blocklist `.github/agent-blocklist.toml` (trailers, names, emails) — single source of truth
  - prepare-commit-msg hook strips Co-authored-by trailers before validation
  - Pre-commit hook rejects commits when author/committer matches blocklist (skips in CI)
  - validate-commit-msg accepts `--blocked-patterns` for TOML blocklist; rejects remaining fingerprints
  - pr-title-check CI scans PR title and body for agent fingerprints
  - Skill rules strengthened (git_commit, worktree_execute, worktree_pr)

## Testing

- [x] Tests pass locally (`uv run pytest packages/vig-utils/tests/` — 271 passed)
- [x] Manual testing performed (prepare-commit-msg strip, check-agent-identity, check-pr-agent-fingerprints)
- [x] Lint passes (`just lint`)

## Checklist

- [x] My code follows the project's style guidelines
- [x] I have performed a self-review of my code
- [x] I have updated `CHANGELOG.md` in the `[Unreleased]` section (and pasted the entry above)
- [x] My changes generate no new warnings or errors
- [x] I have added tests that prove my fix is effective or that my feature works
- [x] New and existing unit tests pass locally with my changes
- [ ] Any dependent changes have been merged and published

## Additional Notes

N/A

Refs: #163



---
---

## Commits

### Commit 1: [d4bbf46](https://github.com/vig-os/devcontainer/commit/d4bbf467aa0667b61802580c2e17bd1b7d26357f) by [gerchowl](https://github.com/gerchowl) on February 24, 2026 at 06:00 PM
fix(vigutils): AI agent identity enforcement — blocklist, prepare-commit-msg, author check, PR body scan, 681 files modified
