---
type: pull_request
state: closed (merged)
branch: bugfix/206-cursor-agent-forkpty-terminal-override â†’ feature/70-remote-devc-orchestration
created: 2026-02-26T11:20:47Z
updated: 2026-02-26T11:44:21Z
author: gerchowl
author_url: https://github.com/gerchowl
url: https://github.com/vig-os/devcontainer/pull/207
comments: 0
labels: none
assignees: gerchowl
milestone: none
projects: none
relationship: none
merged: 2026-02-26T11:44:19Z
synced: 2026-02-27T04:19:12.695Z
---

# [PR 207](https://github.com/vig-os/devcontainer/pull/207) fix(workspace): add terminal.integrated.defaultProfile.linux override to devcontainer.json

## Description

When a user's Cursor/VS Code settings configure `terminal.integrated.defaultProfile.linux` to a shell not present in the container image (e.g. `zsh`), the Agent chat shell fails with `forkpty(3) failed` and the extension host times out. This adds a `"terminal.integrated.defaultProfile.linux": "bash"` setting to the devcontainer.json template so the container always overrides the user's host-side preference.

## Type of Change

- [x] `fix` -- Bug fix

### Modifiers

- [ ] Breaking change (`!`) -- This change breaks backward compatibility

## Changes Made

- Add `"terminal.integrated.defaultProfile.linux": "bash"` to `assets/workspace/.devcontainer/devcontainer.json` settings
- Add BATS test verifying the setting is present in the template
- Update CHANGELOG.md

## Changelog Entry

### Fixed

- **Cursor Agent shell fails with forkpty(3) when host sets zsh as default terminal profile** ([#206](https://github.com/vig-os/devcontainer/issues/206))
  - Add `terminal.integrated.defaultProfile.linux: "bash"` to devcontainer.json template settings
  - Prevents user's host-side shell preference from leaking into the container

## Testing

- [x] Tests pass locally (`npx bats tests/bats/init-workspace.bats`)
- [x] Manual testing performed (describe below)

### Manual Testing Details

- Verified the devcontainer.json template is valid JSON after the change
- Confirmed the new BATS test fails before the fix (RED) and passes after (GREEN)

## Checklist

- [x] My code follows the project's style guidelines
- [x] I have performed a self-review of my code
- [x] I have updated `CHANGELOG.md` in the `[Unreleased]` section (and pasted the entry above)
- [x] My changes generate no new warnings or errors
- [x] I have added tests that prove my fix is effective or that my feature works
- [x] New and existing unit tests pass locally with my changes

## Additional Notes

The container image ships `bash` but not `zsh`. Users with `"terminal.integrated.defaultProfile.linux": "zsh"` in their global Cursor settings hit this silently. The devcontainer.json `customizations.vscode.settings` override ensures the container always uses `bash` regardless of the host-side preference.

Refs: #206


---
---

## Commits

### Commit 1: [93bad08](https://github.com/vig-os/devcontainer/commit/93bad080bc60702e3724065081ea0ce71a2a8f1c) by [gerchowl](https://github.com/gerchowl) on February 26, 2026 at 11:18 AM
test: add failing test for terminal.integrated.defaultProfile.linux in devcontainer.json, 21 files modified (tests/bats/init-workspace.bats)

### Commit 2: [05cb2aa](https://github.com/vig-os/devcontainer/commit/05cb2aa93b89c9fdf5679d38f1a3d8298409e510) by [gerchowl](https://github.com/gerchowl) on February 26, 2026 at 11:19 AM
fix(workspace): add terminal.integrated.defaultProfile.linux override to devcontainer.json, 1 file modified (assets/workspace/.devcontainer/devcontainer.json)

### Commit 3: [c2d386c](https://github.com/vig-os/devcontainer/commit/c2d386c51a0642156575fbeeaf735e88a32fda13) by [gerchowl](https://github.com/gerchowl) on February 26, 2026 at 11:19 AM
docs: update CHANGELOG for terminal profile override fix, 3 files modified (CHANGELOG.md)
