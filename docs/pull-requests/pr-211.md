---
type: pull_request
state: open
branch: feature/208-tailscale-ssh-support → feature/70-remote-devc-orchestration
created: 2026-02-26T18:58:58Z
updated: 2026-02-26T18:59:00Z
author: gerchowl
author_url: https://github.com/gerchowl
url: https://github.com/vig-os/devcontainer/pull/211
comments: 0
labels: none
assignees: gerchowl
milestone: none
projects: none
relationship: none
synced: 2026-02-27T04:19:08.754Z
---

# [PR 211](https://github.com/vig-os/devcontainer/pull/211) feat: add opt-in Tailscale SSH support to devcontainer (#208)

## Description

Add opt-in Tailscale SSH support to the devcontainer workspace template. When `TAILSCALE_AUTHKEY` is set via `docker-compose.local.yaml`, Tailscale is installed at container creation and started on every container start, enabling direct SSH access over the tailnet. When unset, all hooks are silent no-ops — zero impact on existing users.

This enables tools like Cursor GUI to execute shell commands inside the container via SSH remote, working around the known devcontainer protocol limitation.

## Type of Change

- [x] `feat` -- New feature
- [ ] `fix` -- Bug fix
- [ ] `docs` -- Documentation only
- [ ] `chore` -- Maintenance task (deps, config, etc.)
- [ ] `refactor` -- Code restructuring (no behavior change)
- [ ] `test` -- Adding or updating tests
- [ ] `ci` -- CI/CD pipeline changes
- [ ] `build` -- Build system or dependency changes
- [ ] `revert` -- Reverts a previous commit
- [ ] `style` -- Code style (formatting, whitespace)

### Modifiers

- [ ] Breaking change (`!`) -- This change breaks backward compatibility

## Changes Made

- **`assets/workspace/.devcontainer/scripts/setup-tailscale.sh`** (new) — Single script with `install` and `start` subcommands. Uses userspace networking (`--tun=userspace-networking`), Tailscale SSH (`--ssh`), and auto-generates hostname from `devcontainer.json` name field.
- **`assets/workspace/.devcontainer/scripts/post-create.sh`** — Added hook to `setup-tailscale.sh install` after dependency sync.
- **`assets/workspace/.devcontainer/scripts/post-start.sh`** — Added `SCRIPT_DIR` resolution and hook to `setup-tailscale.sh start` after dependency sync.
- **`assets/workspace/.devcontainer/docker-compose.local.yaml`** — Added commented example for `TAILSCALE_AUTHKEY` and `TAILSCALE_HOSTNAME` env vars.
- **`assets/workspace/.devcontainer/README.md`** — Added "Tailscale SSH" section with prerequisites, setup, ACL configuration, and how-it-works documentation.
- **`tests/bats/setup-tailscale.bats`** (new) — 9 BATS tests covering script structure, opt-in gate (no-op when authkey unset/empty), and invalid subcommand handling.
- **`CHANGELOG.md`** — Added entry under `## Unreleased` → `### Added`.

## Changelog Entry

### Added

- **Opt-in Tailscale SSH support for devcontainer** ([#208](https://github.com/vig-os/devcontainer/issues/208))
  - New `setup-tailscale.sh` script with `install` and `start` subcommands
  - Hooks into `post-create.sh` (install) and `post-start.sh` (start)
  - Silent no-op when `TAILSCALE_AUTHKEY` is unset — zero impact on existing users
  - Commented example in `docker-compose.local.yaml` for quick setup
  - Documentation in `.devcontainer/README.md` with quick-start and ACL instructions

## Testing

- [x] Tests pass locally (`just test`)
- [ ] Manual testing performed (describe below)

### Manual Testing Details

N/A — Live Tailscale testing requires network access and a valid authkey. BATS tests cover the opt-in gate logic (the critical behavior).

## Checklist

- [x] My code follows the project's style guidelines
- [x] I have performed a self-review of my code
- [x] I have commented my code, particularly in hard-to-understand areas
- [x] I have updated the documentation accordingly (edit `docs/templates/`, then run `just docs`)
- [x] I have updated `CHANGELOG.md` in the `[Unreleased]` section (and pasted the entry above)
- [x] My changes generate no new warnings or errors
- [x] I have added tests that prove my fix is effective or that my feature works
- [x] New and existing unit tests pass locally with my changes
- [ ] Any dependent changes have been merged and published

## Additional Notes

- Design: [#208 Design comment](https://github.com/vig-os/devcontainer/issues/208#issuecomment-3968551685)
- Implementation Plan: [#208 Plan comment](https://github.com/vig-os/devcontainer/issues/208#issuecomment-3968553610)
- Prototype: `vig-os/fd5` commit `13797db`

Refs: #208

