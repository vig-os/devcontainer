---
type: pull_request
state: closed (merged)
branch: dev → main
created: 2026-01-28T08:39:00Z
updated: 2026-01-28T08:40:41Z
author: c-vigo
author_url: https://github.com/c-vigo
url: https://github.com/vig-os/devcontainer/pull/28
comments: 0
labels: none
assignees: c-vigo
milestone: none
projects: none
relationship: none
merged: 2026-01-28T08:40:34Z
synced: 2026-02-18T08:57:03.945Z
---

# [PR 28](https://github.com/vig-os/devcontainer/pull/28) (feat): improve workflows (sync-issues main bypass + optional manual publish)

## Description

Improve the GitHub Actions workflows:

- `sync-issues.yml`: can push updates even when `main` is protected (PR-only), and supports a user-specified target branch on `workflow_dispatch`.
- `publish-container-image.yml`: manual runs can optionally publish images/manifests (default remains “test only”).

## Related Issue(s)

Closes #

## Type of Change

- [x] Bug fix (non-breaking change which fixes an issue)
- [x] New feature (non-breaking change which adds functionality)
- [ ] Breaking change (fix or feature that would cause existing functionality to not work as expected)
- [ ] Documentation update
- [ ] Refactoring (no functional changes)
- [ ] Test updates

## Changes Made

- **Workflow manual target branch**: add `workflow_dispatch.inputs.target-branch` so a manual run can explicitly commit to `main`/`dev`.
- **Branch protection bypass**: generate a GitHub App installation token via `actions/create-github-app-token@v2` and use it for the commit step (so it can bypass rules when the App is configured in the bypass list).
- **Commit action update**: bump `vig-os/commit-action` from `v0.1.1` to `v0.1.3` and pass the expected env (`GH_TOKEN`, `TARGET_BRANCH`).
- **Manual publish toggle for image workflow**: add `workflow_dispatch.inputs.publish` (default `false`) so manual runs can either:
  - run build+tests only (default), or
  - run build+tests+publish+manifest when `publish=true`.
- **(Sync outputs)**: the workflow run also generated/updated `.github_data/issues/…` and `.github_data/pull-requests/…` content.

## Testing

- [ ] Tests pass locally (`just test`)
- [ ] Manual testing performed (describe below)

### Manual Testing Details

- Trigger `Sync Issues and PRs` via `workflow_dispatch` with `target-branch=main` and confirm it:
  - checks out `main`
  - commits via the GitHub App identity
  - writes to `main` without tripping “PR required” rules (when the App is allowed to bypass)
- Trigger `Publish Container Image` via `workflow_dispatch`:
  - with `publish=false` (default): runs build+tests, does not push images/manifests
  - with `publish=true`: runs build+tests and publishes images/manifests

## Checklist

- [ ] My code follows the project's style guidelines
- [ ] I have performed a self-review of my code
- [ ] I have commented my code, particularly in hard-to-understand areas
- [ ] I have updated the documentation accordingly (README.md, CONTRIBUTE.md, etc.)
- [x] I have updated the CHANGELOG.md in the `[Unreleased]` section
- [ ] My changes generate no new warnings or errors
- [ ] I have added tests that prove my fix is effective or that my feature works
- [ ] New and existing unit tests pass locally with my changes
- [ ] Any dependent changes have been merged and published

## Additional Notes

- Repo settings prerequisite: the GitHub App used here must be installed on the repo and explicitly allowed to bypass the relevant branch protection / ruleset.



---
---

## Commits

### Commit 1: [90d4edf](https://github.com/vig-os/devcontainer/commit/90d4edf2cf1e73e366e0973180b3e28522899748) by [c-vigo](https://github.com/c-vigo) on January 26, 2026 at 09:40 PM
chore: add GitHub App token generation to sync-issues workflow for bypassing branch protection, 11 files modified (.github/workflows/sync-issues.yml)

### Commit 2: [26bbecf](https://github.com/vig-os/devcontainer/commit/26bbecfab1d06475062c976a13b5968470bbea99) by [c-vigo](https://github.com/c-vigo) on January 28, 2026 at 07:10 AM
feat: add target branch input to sync-issues workflow for manual branch specification, 15 files modified (.github/workflows/sync-issues.yml)

### Commit 3: [e4a78c9](https://github.com/vig-os/devcontainer/commit/e4a78c9fc950344b440e2174199c6b0e08ae3dc4) by [c-vigo](https://github.com/c-vigo) on January 28, 2026 at 07:13 AM
fix: update GitHub App token configuration in sync-issues workflow, 4 files modified (.github/workflows/sync-issues.yml)

### Commit 4: [1c8f152](https://github.com/vig-os/devcontainer/commit/1c8f152e6bec5ea1709f68e11691c3c0df786ca1) by [commit-action-bot[bot]](https://github.com/apps/commit-action-bot) on January 28, 2026 at 07:15 AM
chore: sync issues and PRs, 514 files modified (.github_data/issues/issue-27.md, .github_data/pull-requests/pr-26.md)

### Commit 5: [4bc8cc0](https://github.com/vig-os/devcontainer/commit/4bc8cc03d2df830570e65a00b9a9b65fbc33f46a) by [c-vigo](https://github.com/c-vigo) on January 28, 2026 at 08:17 AM
chore: update commit-action version in sync-issues workflow, 4 files modified (.github/workflows/sync-issues.yml)

### Commit 6: [99fdf5a](https://github.com/vig-os/devcontainer/commit/99fdf5ada1726ac6d53f8c9f8aaa122ac6c46a17) by [c-vigo](https://github.com/c-vigo) on January 28, 2026 at 08:29 AM
docs: update CHANGELOG and README for release 0.2.1, 29 files modified (CHANGELOG.md, README.md)

### Commit 7: [a459bdb](https://github.com/vig-os/devcontainer/commit/a459bdbbb4f2f57654d3b3731346a7d45904b3e5) by [c-vigo](https://github.com/c-vigo) on January 28, 2026 at 08:37 AM
feat: add publish option to workflow and improve error messaging, 72 files modified (.github/workflows/publish-container-image.yml, CHANGELOG.md)

### Commit 8: [7c88d7c](https://github.com/vig-os/devcontainer/commit/7c88d7c7c19476b29d1650dc3fc547cdcc34c812) by [c-vigo](https://github.com/c-vigo) on January 28, 2026 at 08:40 AM
Merge branch 'main' into dev, 242 files modified (.github_data/pull-requests/pr-26.md)
