# Dependency Review Exceptions
# Allowed GitHub Security Advisories (GHSAs) for dependency-review-action.
# Mirrors .trivyignore conventions: each GHSA entry requires an Expiration
# directive. Expired exceptions cause CI to fail, forcing periodic review.
#
# Format:
#   # <GHSA-ID>: <short description>
#   # Risk Assessment: <level>
#   # - <detail>
#   # Mitigation: <description>
#   Expiration: <YYYY-MM-DD>
#   <GHSA-ID>

# GHSA-wvrr-2x4r-394v: bats-file@0.2.0 malware (false positive)
# Risk Assessment: FALSE POSITIVE
# - Advisory flags npm registry bats-file@0.2.0 as malware
# - We install from official GitHub source (github:bats-core/bats-file#v0.4.0)
# - Upstream package.json has never updated its version field from 0.2.0
# - The lock file records 0.2.0 regardless of which git tag is used
# Mitigation: Source is verified GitHub repository, not npm registry
Expiration: 2026-06-01
GHSA-wvrr-2x4r-394v

# GHSA-fjxv-7rqg-78g4: form-data@2.3.3 unsafe random function (indirect dependency)
# Risk Assessment: MEDIUM - Requires active MITM to exploit
# - Vulnerability (CVE-2025-7783) affects form-data <2.5.4
# - Transitive dependency: bats-assert → verbose → reconnect → request → form-data@2.3.3
# - verbose, reconnect, and request are unmaintained legacy packages
# - Risk: HTTP Parameter Pollution via predictable boundary values
# - Exploit requires attacker control of request field + observation of random values
# - Impact: Limited in test-only dependency context (CI/development environment)
# - Ongoing investigation of BATS alternatives or direct dependency override
# Mitigation: Transitive dependency through unmaintained packages; usage in CI only
Expiration: 2026-05-17
GHSA-fjxv-7rqg-78g4

# GHSA-h4j5-c7cj-74xg: xmlhttprequest@1.5.0 arbitrary code injection (indirect dependency)
# Risk Assessment: CRITICAL - In unmaintained legacy test dependency context only
# - Vulnerability affects xmlhttprequest@1.5.0 (from 2014)
# - Transitive dependency: bats-assert → verbose → reconnect/engine.io → engine.io-client@0.7.12 → xmlhttprequest@1.5.0
# - verbose, reconnect, and engine.io-client@0.7.12 are unmaintained legacy packages
# - Risk: Arbitrary Code Injection vulnerability (GHSA-h4j5-c7cj-74xg)
# - Impact: Limited in test-only dependency context (CI/development environment)
# - No runtime execution of untrusted xmlhttprequest code in CI tests
# - Being investigated as part of BATS framework modernization efforts
# Mitigation: Transitive dependency through unmaintained packages; isolated CI-only usage
Expiration: 2026-08-17
GHSA-h4j5-c7cj-74xg

# GHSA-9vvw-cc9w-f27h: debug@0.6.0 inefficient regular expression complexity (indirect dependency)
# Risk Assessment: HIGH - In test-only dependency context
# - Vulnerability affects debug@0.6.0 (deprecated version from 2015)
# - Transitive dependency: bats-assert → verbose → debug@0.6.0
# - verbose and debug are unmaintained legacy packages
# - Risk: ReDoS (Regular Expression Denial of Service) via inefficient regex
# - Impact: Limited in test-only dependency context (CI/development environment)
# - Does not affect runtime production code
# Mitigation: Transitive dependency through unmaintained packages; isolated CI-only usage
Expiration: 2026-11-17
GHSA-9vvw-cc9w-f27h
