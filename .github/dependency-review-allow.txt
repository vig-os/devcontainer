# Dependency Review Exceptions
# Allowed GitHub Security Advisories (GHSAs) for dependency-review-action.
# Mirrors .trivyignore conventions: each GHSA entry requires an Expiration
# directive. Expired exceptions cause CI to fail, forcing periodic review.
#
# Format:
#   # <GHSA-ID>: <short description>
#   # Risk Assessment: <level>
#   # - <detail>
#   # Mitigation: <description>
#   Expiration: <YYYY-MM-DD>
#   <GHSA-ID>

# GHSA-wvrr-2x4r-394v: bats-file@0.2.0 malware (false positive)
# Risk Assessment: FALSE POSITIVE
# - Advisory flags npm registry bats-file@0.2.0 as malware
# - We install from official GitHub source (github:bats-core/bats-file#v0.4.0)
# - Upstream package.json has never updated its version field from 0.2.0
# - The lock file records 0.2.0 regardless of which git tag is used
# Mitigation: Source is verified GitHub repository, not npm registry
Expiration: 2026-06-01
GHSA-wvrr-2x4r-394v

# GHSA-fjxv-7rqg-78g4: form-data@2.3.3 unsafe random function (indirect dependency)
# Risk Assessment: MEDIUM - Requires active MITM to exploit
# - Vulnerability (CVE-2025-7783) affects form-data <2.5.4
# - Transitive dependency: bats-assert → verbose → reconnect → request → form-data@2.3.3
# - verbose, reconnect, and request are unmaintained legacy packages
# - Risk: HTTP Parameter Pollution via predictable boundary values
# - Exploit requires attacker control of request field + observation of random values
# - Impact: Limited in test-only dependency context (CI/development environment)
# - Ongoing investigation of BATS alternatives or direct dependency override
# Mitigation: Transitive dependency through unmaintained packages; usage in CI only
Expiration: 2026-05-17
GHSA-fjxv-7rqg-78g4

# GHSA-h4j5-c7cj-74xg: xmlhttprequest@1.5.0 arbitrary code injection (indirect dependency)
# Risk Assessment: CRITICAL - In unmaintained legacy test dependency context only
# - Vulnerability affects xmlhttprequest@1.5.0 (from 2014)
# - Transitive dependency: bats-assert → verbose → reconnect/engine.io → engine.io-client@0.7.12 → xmlhttprequest@1.5.0
# - verbose, reconnect, and engine.io-client@0.7.12 are unmaintained legacy packages
# - Risk: Arbitrary Code Injection vulnerability (GHSA-h4j5-c7cj-74xg)
# - Impact: Limited in test-only dependency context (CI/development environment)
# - No runtime execution of untrusted xmlhttprequest code in CI tests
# - Being investigated as part of BATS framework modernization efforts
# Mitigation: Transitive dependency through unmaintained packages; isolated CI-only usage
Expiration: 2026-08-17
GHSA-h4j5-c7cj-74xg

# GHSA-9vvw-cc9w-f27h: debug@0.6.0 inefficient regular expression complexity (indirect dependency)
# Risk Assessment: HIGH - In test-only dependency context
# - Vulnerability affects debug@0.6.0 (deprecated version from 2015)
# - Transitive dependency: bats-assert → verbose → debug@0.6.0
# - verbose and debug are unmaintained legacy packages
# - Risk: ReDoS (Regular Expression Denial of Service) via inefficient regex
# - Impact: Limited in test-only dependency context (CI/development environment)
# - Does not affect runtime production code
# Mitigation: Transitive dependency through unmaintained packages; isolated CI-only usage
Expiration: 2026-11-17
GHSA-9vvw-cc9w-f27h

# GHSA-gxpj-cx7g-858c: debug@<2.6.9 Regular Expression Denial of Service (indirect dependency)
# Risk Assessment: LOW - In test-only dependency context
# - Vulnerability affects debug <2.6.9
# - Transitive dependency: bats-assert → verbose → debug, engine.io → debug
# - verbose and debug are unmaintained legacy packages
# - Risk: ReDoS (Regular Expression Denial of Service)
# - Impact: Limited in test-only dependency context (CI/development environment)
# Mitigation: Transitive dependency through unmaintained packages; isolated CI-only usage
Expiration: 2026-11-17
GHSA-gxpj-cx7g-858c

# GHSA-r7qp-cfhv-p84w: engine.io@<=3.6.0 uncaught exception (indirect dependency)
# Risk Assessment: MODERATE - In test-only dependency context
# - Vulnerability affects engine.io <=3.6.0
# - Transitive dependency: bats-assert → verbose → reconnect → engine.io
# - Risk: Uncaught exception leading to DoS
# - Impact: Limited in test-only dependency context (CI/development environment)
# Mitigation: Transitive dependency through unmaintained packages; isolated CI-only usage
Expiration: 2026-11-17
GHSA-r7qp-cfhv-p84w

# GHSA-j4f2-536g-r55m: engine.io@<=3.6.0 resource exhaustion (indirect dependency)
# Risk Assessment: HIGH - In test-only dependency context
# - Vulnerability affects engine.io <=3.6.0
# - Transitive dependency: bats-assert → verbose → reconnect → engine.io
# - Risk: Resource exhaustion via large messages
# - Impact: Limited in test-only dependency context (CI/development environment)
# Mitigation: Transitive dependency through unmaintained packages; isolated CI-only usage
Expiration: 2026-11-17
GHSA-j4f2-536g-r55m

# GHSA-265q-28rp-chq5: node-uuid@<1.4.4 insecure entropy source (indirect dependency)
# Risk Assessment: HIGH - In test-only dependency context
# - Vulnerability affects node-uuid <1.4.4 (uses Math.random())
# - Transitive dependency: bats-assert → verbose → reconnect → sockjs → node-uuid
# - Risk: Insecure random number generation
# - Impact: Limited in test-only dependency context (CI/development environment)
# Mitigation: Transitive dependency through unmaintained packages; isolated CI-only usage
Expiration: 2026-11-17
GHSA-265q-28rp-chq5

# GHSA-6rw7-vpxm-498p: qs@<6.14.1 DoS via memory exhaustion (indirect dependency)
# Risk Assessment: HIGH - In test-only dependency context
# - Vulnerability affects qs <6.14.1 (arrayLimit bypass)
# - Transitive dependency: bats-assert → verbose → reconnect → request → qs
# - Risk: DoS via crafted query parameters
# - Impact: Limited in test-only dependency context (CI/development environment)
# Mitigation: Transitive dependency through unmaintained packages; isolated CI-only usage
Expiration: 2026-11-17
GHSA-6rw7-vpxm-498p

# GHSA-72xf-g2v4-qvf3: tough-cookie@<4.1.3 prototype pollution (indirect dependency)
# Risk Assessment: MODERATE - In test-only dependency context
# - Vulnerability affects tough-cookie <4.1.3
# - Transitive dependency: bats-assert → verbose → reconnect → request → tough-cookie
# - Risk: Prototype Pollution via malicious cookie attributes
# - Impact: Limited in test-only dependency context (CI/development environment)
# Mitigation: Transitive dependency through unmaintained packages; isolated CI-only usage
Expiration: 2026-11-17
GHSA-72xf-g2v4-qvf3

# GHSA-6663-c963-2gqg: ws@<=1.1.4 DoS via large websocket message (indirect dependency)
# Risk Assessment: HIGH - In test-only dependency context
# - Vulnerability affects ws <=1.1.4
# - Transitive dependency: bats-assert → verbose → reconnect → engine.io/sockjs-stream → ws
# - Risk: DoS via excessively large websocket messages
# - Impact: Limited in test-only dependency context (CI/development environment)
# Mitigation: Transitive dependency through unmaintained packages; isolated CI-only usage
Expiration: 2026-11-17
GHSA-6663-c963-2gqg

# GHSA-5v72-xg48-5rpm: ws@<=1.1.4 denial of service (indirect dependency)
# Risk Assessment: HIGH - In test-only dependency context
# - Vulnerability affects ws <=1.1.4
# - Transitive dependency: bats-assert → verbose → reconnect → engine.io/sockjs-stream → ws
# - Risk: Denial of Service via malformed frames
# - Impact: Limited in test-only dependency context (CI/development environment)
# Mitigation: Transitive dependency through unmaintained packages; isolated CI-only usage
Expiration: 2026-11-17
GHSA-5v72-xg48-5rpm

# GHSA-2mhh-w6q8-5hxw: ws@<=1.1.4 remote memory disclosure (indirect dependency)
# Risk Assessment: HIGH - In test-only dependency context
# - Vulnerability affects ws <=1.1.4
# - Transitive dependency: bats-assert → verbose → reconnect → engine.io/sockjs-stream → ws
# - Risk: Remote memory disclosure via crafted frames
# - Impact: Limited in test-only dependency context (CI/development environment)
# Mitigation: Transitive dependency through unmaintained packages; isolated CI-only usage
Expiration: 2026-11-17
GHSA-2mhh-w6q8-5hxw
