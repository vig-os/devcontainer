---
type: pull_request
state: open
branch: feature/67-declarative-sync-manifest → dev
created: 2026-02-18T00:58:00Z
updated: 2026-02-18T11:31:42Z
author: gerchowl
author_url: https://github.com/gerchowl
url: https://github.com/vig-os/devcontainer/pull/68
comments: 16
labels: none
assignees: none
milestone: none
projects: none
relationship: none
synced: 2026-02-18T12:21:46.090Z
---

# [PR 68](https://github.com/vig-os/devcontainer/pull/68) feat: agent-driven development workflows, templates, and declarative sync manifest

## Summary

- Add 14 Cursor commands (start-issue, tdd, debug, review, submit-pr, etc.) and 2 Cursor rules (coding-principles, tdd) for agent-driven development workflows (#63)
- Add agent-friendly issue templates, changelog Cursor rule, and PR template enhancements (#61)
  - New templates: `refactor.yml`, `documentation.yml`, `ci_build.yml`, `config.yml`
  - New rule: `.cursor/rules/changelog.mdc` (always applied)
  - PR template enhanced with Changelog Entry section and CI/Build change type
- Replace the dual sync system (`sync-manifest.txt` + bash function in `prepare-build.sh`, and `sync-workspace.sh` shell script) with a single declarative Python manifest (`scripts/sync_manifest.py`) (#67)
- Sync Cursor rules, commands, GitHub templates, dependabot config, and pre-commit config into `assets/workspace/` with automated transformations
- Update `test_manifest_files` to skip checksum verification for intentionally transformed entries

Closes #61
Closes #63
Closes #67

### Key files

| File | Purpose |
|------|---------|
| `scripts/sync_manifest.py` | Declarative manifest: what to sync + transforms |
| `.cursor/commands/*.md` | 14 new agent workflow commands |
| `.cursor/rules/*.mdc` | 3 new always-on rules (coding-principles, tdd, changelog) |
| `.github/ISSUE_TEMPLATE/*.yml` | 6 issue templates + config.yml |
| `.github/pull_request_template.md` | Enhanced PR template |
| `scripts/prepare-build.sh` | Now calls `sync_manifest.py` instead of bash function |

### Transforms applied to workspace template

- `.pre-commit-config.yaml`: remove `generate-docs` hook, generalize Bandit paths, comment out `validate-commit-msg` args
- `.github/dependabot.yml`: remove Docker ecosystem section
- `.cursor/rules/commit-messages.mdc`: remove repo-specific doc link
- `.cursor/commands/tdd.md`, `verify.md`: generalize test recipe names

## Test plan

- [ ] CI passes (build image, project checks, image tests, integration tests)
- [ ] `just sync-workspace` produces correct output
- [ ] `uv run python scripts/sync_manifest.py list --transformed` shows 4 transformed entries
- [ ] YAML validation passes on generated workspace `.pre-commit-config.yaml` and `dependabot.yml`
- [ ] New issue templates render correctly on GitHub


---
---

## Comments (16)

### [Comment #1](https://github.com/vig-os/devcontainer/pull/68#issuecomment-3919321616) by [@gerchowl](https://github.com/gerchowl)

_Posted on February 18, 2026 at 08:11 AM_

## Idea: Use GitHub issue bodies for implementation plan tracking instead of `docs/plans/` files

The current `/plan` command writes plans to `docs/plans/YYYY-MM-DD-<name>-plan.md` and `/execute-plan` reads from there. An alternative approach: write and track the implementation plan directly in the **GitHub issue body** (using task lists / checkboxes), and have the agent update task status there as work progresses.

### How it would work

- `/plan` reads the issue, breaks it into tasks, then **appends or replaces a "## Implementation Plan" section** in the issue body (via `gh issue edit --body`).
- `/execute-plan` reads the issue body, picks up unchecked tasks, executes them, and **checks them off** in the issue body as they complete.
- The issue becomes the single source of truth for both *what* needs doing and *what's done*.

### Pros of issue-body plans

| | |
|---|---|
| **Single source of truth** | Plan lives where the work is tracked — no separate file to keep in sync with the issue. |
| **Visible to the whole team** | Anyone looking at the issue instantly sees progress — no need to find and read a local `docs/plans/` file or check it out. |
| **No repo clutter** | Avoids accumulating plan markdown files in `docs/plans/` that become stale after merge. |
| **GitHub-native progress** | Task lists in issue bodies render as progress bars in issue lists and project boards. |
| **Cross-agent continuity** | A new agent session (or different worktree) can pick up where the last left off — just read the issue body. No need to find the right plan file. |
| **Audit trail via issue edit history** | GitHub tracks every edit to the issue body, so you get a changelog of plan evolution for free. |

### Cons / risks of issue-body plans

| | |
|---|---|
| **API rate limits** | Frequent `gh issue edit` calls (after every 2-3 task batch) could hit GitHub API rate limits, especially with multiple agents. |
| **Concurrent edit conflicts** | If two agents or a human edit the issue body at the same time, last-write-wins — edits can be lost. `docs/plans/` files at least get merge conflict detection via git. |
| **Size limits** | GitHub issue bodies have a ~65k character limit. Complex plans with detailed sub-tasks could get close. Plan files have no practical limit. |
| **Less structured** | Markdown in an issue body is harder to parse reliably than a dedicated plan file with a known schema. Edge cases in formatting could trip up the agent. |
| **Offline / local-first workflows** | Plan files work without network access; issue-body plans require connectivity for every read/write. |
| **Pollutes issue body** | The issue body serves double duty (problem description + implementation plan), which can make it long and harder for humans to scan. A `<details>` collapse could mitigate this. |
| **`/plan` origin (superpowers repo)** | The current `/plan` + `/execute-plan` pattern comes from the [superpowers](https://github.com/rileytomasek/cursor-superpowers) community repo. Keeping the file-based approach means we stay compatible with that ecosystem and its updates. Diverging means maintaining our own variant. |

### Possible hybrid approach

Use **both**: write a concise task checklist into the issue body for visibility and cross-agent continuity, but keep the detailed plan (file paths, verification steps, dependencies) in `docs/plans/` for structured parsing and offline use. The issue body becomes the "dashboard" and the plan file is the "spec".

---

Worth discussing whether the visibility and cross-agent continuity benefits outweigh the API/concurrency risks, or whether a hybrid gives us the best of both worlds.

---

### [Comment #2](https://github.com/vig-os/devcontainer/pull/68#issuecomment-3919327460) by [@gerchowl](https://github.com/gerchowl)

_Posted on February 18, 2026 at 08:12 AM_

**Correction on the "offline" con above:** The offline/local-first argument is pretty much irrelevant — the agents require network access anyway (GitHub API, MCP servers, tool calls, etc.). If the network is down, the agent can't work regardless of where the plan lives. So that con effectively drops off the list.

---

### [Comment #3](https://github.com/vig-os/devcontainer/pull/68#issuecomment-3919336528) by [@gerchowl](https://github.com/gerchowl)

_Posted on February 18, 2026 at 08:14 AM_

**Additional thought: tie `/plan` to issue context as a precondition**

Rather than allowing `/plan` to run in isolation, we should enforce that a plan can only be created/executed when the agent is **already on an issue branch** (or runs `/start-issue` first to get on one). This means:

1. `/plan` checks that the current branch matches `<type>/<issue_number>-*` (per our branch naming convention).
2. If not on an issue branch, it refuses and tells the agent to run `/start-issue` first.
3. The plan is then inherently scoped to that issue — the issue number is known, the issue body is accessible, and there's no ambiguity about *what* the plan is for.

**Why this matters for the issue-body approach:**

- If `/plan` always knows which issue it's working on, writing the plan into the issue body becomes trivial — no guessing, no "which issue?" prompts.
- It also prevents orphaned plan files in `docs/plans/` that aren't tied to any issue.
- The workflow becomes: `/start-issue` → `/plan` (writes to issue body) → `/execute-plan` (reads from issue body, checks off tasks) → `/submit-pr`. Clean linear pipeline, single source of truth throughout.

**This also works with the file-based approach** — even if we keep `docs/plans/`, gating `/plan` behind issue context means the plan file can be named `docs/plans/<issue_number>-<summary>-plan.md` and always references back to its issue. But it makes the argument for issue-body plans stronger since the issue is already the anchor point.

---

### [Comment #4](https://github.com/vig-os/devcontainer/pull/68#issuecomment-3919983081) by [@c-vigo](https://github.com/c-vigo)

_Posted on February 18, 2026 at 10:27 AM_

From `changelog.mdc`:

```
- **Skip** for `chore` commits that are purely internal (dependency bumps, CI-only config tweaks, formatting) unless they have user-visible impact.
```
Are we sure about this? I'd argue that a version bump by dependabot should be documented in the CHANGELOG.

---

### [Comment #5](https://github.com/vig-os/devcontainer/pull/68#issuecomment-3919996744) by [@c-vigo](https://github.com/c-vigo)

_Posted on February 18, 2026 at 10:29 AM_

I'd try to reduce token utilization with e.g. `commit-messages.mdc`:

```
---
description: Commit message format and rules (type, Refs)
alwaysApply: false
triggers:
  - command: "commit-msg"
---
```

Just an example, may be others.

---

### [Comment #6](https://github.com/vig-os/devcontainer/pull/68#issuecomment-3920159677) by [@c-vigo](https://github.com/c-vigo)

_Posted on February 18, 2026 at 11:02 AM_

For plans, I would propose adding them as comments to an existing issue:

- Preserves history
- Limit of 262144 bytes (65536-262144 characters depending on UTF8-encoded size) as per [this link](https://github.com/dead-claudia/github-limits)
- Does not trigger a sync-issue workflow, but we can manually run it targeting the topic branch so keep other branches clean

If so, pipeline could be:

- Agent proposes a plan in a temporary MD file.
- User reviews, optionally modifies and eventually approves.
- Agent publishes a comment on the issue using `gh` with proper formatting.
- Agent triggers a sync-issue manual dispatch targetting the issue branch
- Agent waits, verifies sync-issue workflow progress and pulls
- Plan is available as latest comment in issue file

---

Note on issue comment formatting:

- If the content starts with # (H1): All headers in that content are bumped down one level (# becomes ##, ## becomes ###, etc., up to ###### which stays as-is). This avoids clashing with the synced file's own H1 headers.
- If the content does NOT start with # : Headers are left completely untouched. So if a comment only uses ## or lower, nothing changes.

---

### [Comment #7](https://github.com/vig-os/devcontainer/pull/68#issuecomment-3920174152) by [@gerchowl](https://github.com/gerchowl)

_Posted on February 18, 2026 at 11:05 AM_

> If so, pipeline could be:
> 
> * Agent proposes a plan in a temporary MD file.
> * User reviews, optionally modifies and eventually approves.
> * Agent publishes a comment on the issue using `gh` with proper formatting.
> * Agent triggers a sync-issue manual dispatch targetting the issue branch
> * Agent waits, verifies sync-issue workflow progress and pulls
> * Plan is available as latest comment in issue file

dont think a wait is needed. whatever is added as a comment persists in that chat. also the sync-issue round trip will introduce wait? bad for DX?

---

### [Comment #8](https://github.com/vig-os/devcontainer/pull/68#issuecomment-3920177003) by [@c-vigo](https://github.com/c-vigo)

_Posted on February 18, 2026 at 11:06 AM_

Question: can (or already does) `sync_manifest.py` replace `utils.py`?

---

### [Comment #9](https://github.com/vig-os/devcontainer/pull/68#issuecomment-3920189916) by [@c-vigo](https://github.com/c-vigo)

_Posted on February 18, 2026 at 11:08 AM_

> dont think a wait is needed. whatever is added as a comment persists in that chat. also the sync-issue round trip will introduce wait? bad for DX?

It makes the plan persistently available locally, e.g. if you launch another plan. One can trigger the workflow but not wait for faster dev time.


---

### [Comment #10](https://github.com/vig-os/devcontainer/pull/68#issuecomment-3920203770) by [@c-vigo](https://github.com/c-vigo)

_Posted on February 18, 2026 at 11:12 AM_

I see the files referenced by the manifest are now permanently duplicated, is this intentional? My approach was syncing them at build time, since some replacements like version or dates can only happen there.

---

### [Comment #11](https://github.com/vig-os/devcontainer/pull/68#issuecomment-3920204605) by [@gerchowl](https://github.com/gerchowl)

_Posted on February 18, 2026 at 11:12 AM_

> I'd try to reduce token utilization with e.g. `commit-messages.mdc`:
> 
> ```
> ---
> description: Commit message format and rules (type, Refs)
> alwaysApply: false
> triggers:
>   - command: "commit-msg"
> ---
> ```
> 
> Just an example, may be others.

yeah one can generally introduce more granularity with a 'tree' model of rules and cmds that reference each other for specific use cases to reduce token usage, apparantly the `changelog.mdc` is 614 tokens.

---

### [Comment #12](https://github.com/vig-os/devcontainer/pull/68#issuecomment-3920236214) by [@gerchowl](https://github.com/gerchowl)

_Posted on February 18, 2026 at 11:18 AM_

> I see the files referenced by the manifest are now permanently duplicated, is this intentional? My approach was syncing them at build time, since some replacements like version or dates can only happen there.


see [#67](https://github.com/vig-os/devcontainer/issues/67)

yes. as in, so far everything was 1-to-1 applicable for the actual deployed devcontainer, many of the rules and configs done in the devc dev repo should go to the devcontainer as well, but some need changes, some parts of files are 'not wanted', how to deal with that? i though a copy und potentially a commit during dev makes one assess if the change should go to the devcontainer. 
now one could layer the copy & replace, i thought a single point of truth here gives better developer experience

one could adopt the logic to have it sync stuff at different times through the manifest.

---

### [Comment #13](https://github.com/vig-os/devcontainer/pull/68#issuecomment-3920239948) by [@gerchowl](https://github.com/gerchowl)

_Posted on February 18, 2026 at 11:19 AM_

> > dont think a wait is needed. whatever is added as a comment persists in that chat. also the sync-issue round trip will introduce wait? bad for DX?
> 
> It makes the plan persistently available locally, e.g. if you launch another plan. One can trigger the workflow but not wait for faster dev time.

sorry, i was unclear, the wait is not required in the workflow. with having it as comments and then sync is a good way!

---

### [Comment #14](https://github.com/vig-os/devcontainer/pull/68#issuecomment-3920267853) by [@c-vigo](https://github.com/c-vigo)

_Posted on February 18, 2026 at 11:25 AM_

There is a clash between the template labels in `.github/ISSUE_TEMPLATE` and the [default labels](https://github.com/organizations/vig-os/settings/repository-defaults) (which only apply to new repos, existing ones must be edited manually). The clash will only become visible when these changes are merged into `main`.

---

### [Comment #15](https://github.com/vig-os/devcontainer/pull/68#issuecomment-3920276550) by [@gerchowl](https://github.com/gerchowl)

_Posted on February 18, 2026 at 11:27 AM_

> Question: can (or already does) `sync_manifest.py` replace `utils.py`?

not sure if the sed from `utils.py` is not used elsewhere.
i'd opt more for the case of refactoring the classes and functions of the manifest to the utils so the manifest is like a 'conf'. (i also thought about making it an actual toml or sth. that gets parsed, which would be even nicer..) but refrained for a first implementation of it to understand what'd be needed for this

---

### [Comment #16](https://github.com/vig-os/devcontainer/pull/68#issuecomment-3920295361) by [@gerchowl](https://github.com/gerchowl)

_Posted on February 18, 2026 at 11:31 AM_

> There is a clash between the template labels in `.github/ISSUE_TEMPLATE` and the [default labels](https://github.com/organizations/vig-os/settings/repository-defaults) (which only apply to new repos, existing ones must be edited manually). The clash will only become visible when these changes are merged into `main`.

solution suggestions?

we can set ours as we like, or we have on 'curl  .. install.sh' a `create-gh-issue-labels.sh` that adds a set we agree on to the repo?

---

