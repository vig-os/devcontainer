# Workspace sync manifest â€” declarative config for sync_manifest.py
# Single source of truth for files copied into assets/workspace/ and their transforms.

[[entries]]
src = "docs/COMMIT_MESSAGE_STANDARD.md"

[[entries]]
src = ".cursor/rules/"
transforms = [
  { type = "RemoveLines", pattern = "Full reference: \\[docs/COMMIT_MESSAGE_STANDARD\\.md\\]", target = "commit-messages.mdc" }
]

[[entries]]
src = ".cursor/skills/"
transforms = [
  { type = "Sed", pattern = "just test-image", replace = "just test", target = "code:verify/SKILL.md" },
  { type = "Sed", pattern = "just test-image", replace = "just test", target = "design:plan/SKILL.md" }
]

[[entries]]
src = ".cursor/worktrees.json"

[[entries]]
src = ".gitmessage"

[[entries]]
src = ".yamllint"

[[entries]]
src = ".pymarkdown"

[[entries]]
src = ".pymarkdown.config.md"

[[entries]]
src = ".hadolint.yaml"

[[entries]]
src = ".github/agent-blocklist.toml"

[[entries]]
src = ".github/label-taxonomy.toml"

[[entries]]
src = ".github/pull_request_template.md"

[[entries]]
src = ".github/ISSUE_TEMPLATE/"

[[entries]]
src = ".github/actions/setup-env/"

[[entries]]
src = ".github/dependabot.yml"
transforms = [
  { type = "RemoveBlock", start_pattern = "^\\s+# Docker", end_pattern = "^$" },
  { type = "StripTrailingBlankLines" }
]

[[entries]]
src = ".github/workflows/scorecard.yml"

[[entries]]
src = ".github/workflows/sync-issues.yml"

[[entries]]
src = ".github/workflows/codeql.yml"

[[entries]]
src = "justfile.base"
dest = ".devcontainer/justfile.base"

[[entries]]
src = "justfile.gh"
dest = ".devcontainer/justfile.gh"

[[entries]]
src = "scripts/gh_issues.py"
dest = ".devcontainer/scripts/gh_issues.py"

[[entries]]
src = "scripts/resolve-branch.sh"
dest = ".devcontainer/scripts/resolve-branch.sh"

[[entries]]
src = "scripts/derive-branch-summary.sh"
dest = ".devcontainer/scripts/derive-branch-summary.sh"

[[entries]]
src = "scripts/check-skill-names.sh"
dest = ".devcontainer/scripts/check-skill-names.sh"

[[entries]]
src = "scripts/prepare-commit-msg-strip-trailers.py"
dest = ".devcontainer/scripts/prepare-commit-msg-strip-trailers.py"

[[entries]]
src = "scripts/check-agent-identity.py"
dest = ".devcontainer/scripts/check-agent-identity.py"

[[entries]]
src = "scripts/check-pr-agent-fingerprints.py"
dest = ".devcontainer/scripts/check-pr-agent-fingerprints.py"

[[entries]]
src = "justfile.worktree"
dest = ".devcontainer/justfile.worktree"

[[entries]]
src = ".pre-commit-config.yaml"
transforms = [
  { type = "RemovePrecommitHooks", hook_ids = ["generate-docs"] },
  { type = "Sed", pattern = "bandit -r packages/vig-utils/src/ scripts/ assets/workspace/", replace = "bandit -r src/" },
  { type = "Sed", pattern = "scripts/check-skill-names.sh", replace = ".devcontainer/scripts/check-skill-names.sh" },
  { type = "Sed", pattern = "scripts/prepare-commit-msg-strip-trailers.py", replace = ".devcontainer/scripts/prepare-commit-msg-strip-trailers.py" },
  { type = "Sed", pattern = "scripts/check-agent-identity.py", replace = ".devcontainer/scripts/check-agent-identity.py" },
  { type = "ReplaceBlock", start_pattern = "^\\s+args: \\[$", end_pattern = "^\\s+\\]$", replacement = """
        # Optional: customize commit types, scopes, or refs-optional types via CLI arguments.
        # By default, scopes are not enforced. Set --scopes to require specific scopes.
        # Examples (choose one args line):
        #   args: ["--types", "feat,fix,docs,chore"]
        #   args: ["--scopes", "api,cli,utils"]
        #   args: ["--refs-optional-types", "chore"]
        #   args: ["--types", "feat,fix,docs", "--scopes", "api,cli,utils", "--refs-optional-types", "chore"]
""" }
]
